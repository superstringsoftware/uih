{-# LANGUAGE OverloadedStrings, TypeSynonymInstances, FlexibleInstances #-}
module Color where
import Linear
import Data.Word

import Control.Monad
import qualified Data.ByteString.Char8 as B
import qualified Data.ByteString.Lazy.Char8 as L

-- Materal design colors implemented as pattern-matched functions
type Color = V4 Word8
-- RGBA color
data RGBA = RGBA {r :: !Word8, g :: !Word8, b :: !Word8, a :: !Word8} deriving (Show, Eq)
-- data RGB = RGB {r :: !Word8, g :: !Word8, b :: !Word8} deriving (Show, Eq)

-- toRGBA rgb = RGBA {r = r rgb, g = g rgb, }
--rgbaToSDLColor :: RGBA -> Raw.Color
rgbaToV4Color c = V4 (r c) (g c) (b c) (a c)

mBlack :: Color
mBlack = V4 0 0 0 255
mWhite :: Color
mWhite = V4 255 255 255 255

-- mGrey :: Int -> RGBA
mGrey 500 = V4 0x9E 0x9E 0x9E 255
mGrey 50  = V4 0xFA 0xFA 0xFA 255
mGrey 100 = V4 0xF5 0xF5 0xF5 255
mGrey 300 = V4 0xE0 0xE0 0xE0 255
mGrey 700 = V4 0x61 0x61 0x61 255
mGrey 900 = V4 0x21 0x21 0x21 255
mGrey _   = V4 0x9E 0x9E 0x9E 255

-- mBlue :: Int -> RGBA
mBlue 500 = V4 0x21 0x96 0xF3 255
mBlue _   = V4 0x21 0x96 0xF3 255

-- mRed :: Int -> RGBA
mRed 500  = V4 0xF4 0x43 0x36 255
mRed  _   = V4 0xF4 0x43 0x36 255



mdBlack = V4 0 0 0 255
mdWhite = V4 255 255 255 255


-- | Convert strings into hexadecimal and back.
class Hex t where
    -- | Convert string into hexadecimal.
    hex   :: t -> t
    -- | Convert from hexadecimal and fail on invalid input.
    unhex :: Monad m => t -> m t


instance Hex String where
    hex = Prelude.concatMap w
        where w ch = let s = "0123456789ABCDEF"
                         x = fromEnum ch
                     in [s !! div x 16,s !! mod x 16]
    unhex []      = return []
    unhex (a:b:r) = do x <- c a
                       y <- c b
                       liftM (toEnum ((x * 16) + y) :) $ unhex r
    unhex [_]      = fail "Non-even length"


c :: Monad m => Char -> m Int
c '0' = return 0
c '1' = return 1
c '2' = return 2
c '3' = return 3
c '4' = return 4
c '5' = return 5
c '6' = return 6
c '7' = return 7
c '8' = return 8
c '9' = return 9
c 'A' = return 10
c 'B' = return 11
c 'C' = return 12
c 'D' = return 13
c 'E' = return 14
c 'F' = return 15
c 'a' = return 10
c 'b' = return 11
c 'c' = return 12
c 'd' = return 13
c 'e' = return 14
c 'f' = return 15
c _   = fail "Invalid hex digit!"

instance Hex B.ByteString where
    hex = B.pack . hex . B.unpack
    unhex x = liftM B.pack $ unhex $ B.unpack x

instance Hex L.ByteString where
    hex = L.pack . hex . L.unpack
    unhex x = liftM L.pack $ unhex $ L.unpack x

--
mdRed	50	        = V4 0xFF 0xEB 0xEE 0xFF
mdRed	100	        = V4 0xFF 0xCD 0xD2 0xFF
mdRed	200	        = V4 0xEF 0x9A 0x9A 0xFF
mdRed	300	        = V4 0xE5 0x73 0x73 0xFF
mdRed	400	        = V4 0xEF 0x53 0x50 0xFF
mdRed	500	        = V4 0xF4 0x43 0x36 0xFF
mdRed	600	        = V4 0xE5 0x39 0x35 0xFF
mdRed	700	        = V4 0xD3 0x2F 0x2F 0xFF
mdRed	800	        = V4 0xC6 0x28 0x28 0xFF
mdRed	900	        = V4 0xB7 0x1C 0x1C 0xFF
mdRedA	100	        = V4 0xFF 0x8A 0x80 0xFF
mdRedA	200	        = V4 0xFF 0x52 0x52 0xFF
mdRedA	400	        = V4 0xFF 0x17 0x44 0xFF
mdRedA	700	        = V4 0xD5 0x00 0x00 0xFF
mdPink	50	        = V4 0xFC 0xE4 0xEC 0xFF
mdPink	100	        = V4 0xF8 0xBB 0xD0 0xFF
mdPink	200	        = V4 0xF4 0x8F 0xB1 0xFF
mdPink	300	        = V4 0xF0 0x62 0x92 0xFF
mdPink	400	        = V4 0xEC 0x40 0x7A 0xFF
mdPink	500	        = V4 0xE9 0x1E 0x63 0xFF
mdPink	600	        = V4 0xD8 0x1B 0x60 0xFF
mdPink	700	        = V4 0xC2 0x18 0x5B 0xFF
mdPink	800	        = V4 0xAD 0x14 0x57 0xFF
mdPink	900	        = V4 0x88 0x0E 0x4F 0xFF
mdPinkA	100	        = V4 0xFF 0x80 0xAB 0xFF
mdPinkA	200	        = V4 0xFF 0x40 0x81 0xFF
mdPinkA	400	        = V4 0xF5 0x00 0x57 0xFF
mdPinkA	700	        = V4 0xC5 0x11 0x62 0xFF
mdPurple	50	    = V4 0xF3 0xE5 0xF5 0xFF
mdPurple	100	    = V4 0xE1 0xBE 0xE7 0xFF
mdPurple	200	    = V4 0xCE 0x93 0xD8 0xFF
mdPurple	300	    = V4 0xBA 0x68 0xC8 0xFF
mdPurple	400	    = V4 0xAB 0x47 0xBC 0xFF
mdPurple	500	    = V4 0x9C 0x27 0xB0 0xFF
mdPurple	600	    = V4 0x8E 0x24 0xAA 0xFF
mdPurple	700	    = V4 0x7B 0x1F 0xA2 0xFF
mdPurple	800	    = V4 0x6A 0x1B 0x9A 0xFF
mdPurple	900	    = V4 0x4A 0x14 0x8C 0xFF
mdPurpleA	100	    = V4 0xEA 0x80 0xFC 0xFF
mdPurpleA	200	    = V4 0xE0 0x40 0xFB 0xFF
mdPurpleA	400	    = V4 0xD5 0x00 0xF9 0xFF
mdPurpleA	700	    = V4 0xAA 0x00 0xFF 0xFF
mdDeepPurple	50	= V4 0xED 0xE7 0xF6 0xFF
mdDeepPurple	100	= V4 0xD1 0xC4 0xE9 0xFF
mdDeepPurple	200	= V4 0xB3 0x9D 0xDB 0xFF
mdDeepPurple	300	= V4 0x95 0x75 0xCD 0xFF
mdDeepPurple	400	= V4 0x7E 0x57 0xC2 0xFF
mdDeepPurple	500	= V4 0x67 0x3A 0xB7 0xFF
mdDeepPurple	600	= V4 0x5E 0x35 0xB1 0xFF
mdDeepPurple	700	= V4 0x51 0x2D 0xA8 0xFF
mdDeepPurple	800	= V4 0x45 0x27 0xA0 0xFF
mdDeepPurple	900	= V4 0x31 0x1B 0x92 0xFF
mdDeepPurpleA	100	= V4 0xB3 0x88 0xFF 0xFF
mdDeepPurpleA	200	= V4 0x7C 0x4D 0xFF 0xFF
mdDeepPurpleA	400	= V4 0x65 0x1F 0xFF 0xFF
mdDeepPurpleA	700	= V4 0x62 0x00 0xEA 0xFF
mdIndigo	50	    = V4 0xE8 0xEA 0xF6 0xFF
mdIndigo	100	    = V4 0xC5 0xCA 0xE9 0xFF
mdIndigo	200	    = V4 0x9F 0xA8 0xDA 0xFF
mdIndigo	300	    = V4 0x79 0x86 0xCB 0xFF
mdIndigo	400	    = V4 0x5C 0x6B 0xC0 0xFF
mdIndigo	500	    = V4 0x3F 0x51 0xB5 0xFF
mdIndigo	600	    = V4 0x39 0x49 0xAB 0xFF
mdIndigo	700	    = V4 0x30 0x3F 0x9F 0xFF
mdIndigo	800	    = V4 0x28 0x35 0x93 0xFF
mdIndigo	900	    = V4 0x1A 0x23 0x7E 0xFF
mdIndigoA	100	    = V4 0x8C 0x9E 0xFF 0xFF
mdIndigoA	200	    = V4 0x53 0x6D 0xFE 0xFF
mdIndigoA	400	    = V4 0x3D 0x5A 0xFE 0xFF
mdIndigoA	700	    = V4 0x30 0x4F 0xFE 0xFF
mdBlue	50	        = V4 0xE3 0xF2 0xFD 0xFF
mdBlue	100	        = V4 0xBB 0xDE 0xFB 0xFF
mdBlue	200	        = V4 0x90 0xCA 0xF9 0xFF
mdBlue	300	        = V4 0x64 0xB5 0xF6 0xFF
mdBlue	400	        = V4 0x42 0xA5 0xF5 0xFF
mdBlue	500	        = V4 0x21 0x96 0xF3 0xFF
mdBlue	600	        = V4 0x1E 0x88 0xE5 0xFF
mdBlue	700	        = V4 0x19 0x76 0xD2 0xFF
mdBlue	800	        = V4 0x15 0x65 0xC0 0xFF
mdBlue	900	        = V4 0x0D 0x47 0xA1 0xFF
mdBlueA	100	        = V4 0x82 0xB1 0xFF 0xFF
mdBlueA	200	        = V4 0x44 0x8A 0xFF 0xFF
mdBlueA	400	        = V4 0x29 0x79 0xFF 0xFF
mdBlueA	700	        = V4 0x29 0x62 0xFF 0xFF
mdLightBlue	50	    = V4 0xE1 0xF5 0xFE 0xFF
mdLightBlue	100	    = V4 0xB3 0xE5 0xFC 0xFF
mdLightBlue	200	    = V4 0x81 0xD4 0xFA 0xFF
mdLightBlue	300	    = V4 0x4F 0xC3 0xF7 0xFF
mdLightBlue	400	    = V4 0x29 0xB6 0xF6 0xFF
mdLightBlue	500	    = V4 0x03 0xA9 0xF4 0xFF
mdLightBlue	600	    = V4 0x03 0x9B 0xE5 0xFF
mdLightBlue	700	    = V4 0x02 0x88 0xD1 0xFF
mdLightBlue	800	    = V4 0x02 0x77 0xBD 0xFF
mdLightBlue	900	    = V4 0x01 0x57 0x9B 0xFF
mdLightBlueA	100	= V4 0x80 0xD8 0xFF 0xFF
mdLightBlueA	200	= V4 0x40 0xC4 0xFF 0xFF
mdLightBlueA	400	= V4 0x00 0xB0 0xFF 0xFF
mdLightBlueA	700	= V4 0x00 0x91 0xEA 0xFF
mdCyan	50	= V4 0xE0 0xF7 0xFA 0xFF
mdCyan	100	= V4 0xB2 0xEB 0xF2 0xFF
mdCyan	200	= V4 0x80 0xDE 0xEA 0xFF
mdCyan	300	= V4 0x4D 0xD0 0xE1 0xFF
mdCyan	400	= V4 0x26 0xC6 0xDA 0xFF
mdCyan	500	= V4 0x00 0xBC 0xD4 0xFF
mdCyan	600	= V4 0x00 0xAC 0xC1 0xFF
mdCyan	700	= V4 0x00 0x97 0xA7 0xFF
mdCyan	800	= V4 0x00 0x83 0x8F 0xFF
mdCyan	900	= V4 0x00 0x60 0x64 0xFF
mdCyanA	100	= V4 0x84 0xFF 0xFF 0xFF
mdCyanA	200	= V4 0x18 0xFF 0xFF 0xFF
mdCyanA	400	= V4 0x00 0xE5 0xFF 0xFF
mdCyanA	700	= V4 0x00 0xB8 0xD4 0xFF
mdTeal	50	= V4 0xE0 0xF2 0xF1 0xFF
mdTeal	100	= V4 0xB2 0xDF 0xDB 0xFF
mdTeal	200	= V4 0x80 0xCB 0xC4 0xFF
mdTeal	300	= V4 0x4D 0xB6 0xAC 0xFF
mdTeal	400	= V4 0x26 0xA6 0x9A 0xFF
mdTeal	500	= V4 0x00 0x96 0x88 0xFF
mdTeal	600	= V4 0x00 0x89 0x7B 0xFF
mdTeal	700	= V4 0x00 0x79 0x6B 0xFF
mdTeal	800	= V4 0x00 0x69 0x5C 0xFF
mdTeal	900	= V4 0x00 0x4D 0x40 0xFF
mdTealA	100	= V4 0xA7 0xFF 0xEB 0xFF
mdTealA	200	= V4 0x64 0xFF 0xDA 0xFF
mdTealA	400	= V4 0x1D 0xE9 0xB6 0xFF
mdTealA	700	= V4 0x00 0xBF 0xA5 0xFF
mdGreen	50	= V4 0xE8 0xF5 0xE9 0xFF
mdGreen	100	= V4 0xC8 0xE6 0xC9 0xFF
mdGreen	200	= V4 0xA5 0xD6 0xA7 0xFF
mdGreen	300	= V4 0x81 0xC7 0x84 0xFF
mdGreen	400	= V4 0x66 0xBB 0x6A 0xFF
mdGreen	500	= V4 0x4C 0xAF 0x50 0xFF
mdGreen	600	= V4 0x43 0xA0 0x47 0xFF
mdGreen	700	= V4 0x38 0x8E 0x3C 0xFF
mdGreen	800	= V4 0x2E 0x7D 0x32 0xFF
mdGreen	900	= V4 0x1B 0x5E 0x20 0xFF
mdGreenA	100	    = V4 0xB9 0xF6 0xCA 0xFF
mdGreenA	200	    = V4 0x69 0xF0 0xAE 0xFF
mdGreenA	400	    = V4 0x00 0xE6 0x76 0xFF
mdGreenA	700	    = V4 0x00 0xC8 0x53 0xFF
mdLightGreen	50	= V4 0xF1 0xF8 0xE9 0xFF
mdLightGreen	100	= V4 0xDC 0xED 0xC8 0xFF
mdLightGreen	200	= V4 0xC5 0xE1 0xA5 0xFF
mdLightGreen	300	= V4 0xAE 0xD5 0x81 0xFF
mdLightGreen	400	= V4 0x9C 0xCC 0x65 0xFF
mdLightGreen	500	= V4 0x8B 0xC3 0x4A 0xFF
mdLightGreen	600	= V4 0x7C 0xB3 0x42 0xFF
mdLightGreen	700	= V4 0x68 0x9F 0x38 0xFF
mdLightGreen	800	= V4 0x55 0x8B 0x2F 0xFF
mdLightGreen	900	= V4 0x33 0x69 0x1E 0xFF
mdLightGreenA	100	= V4 0xCC 0xFF 0x90 0xFF
mdLightGreenA	200	= V4 0xB2 0xFF 0x59 0xFF
mdLightGreenA	400	= V4 0x76 0xFF 0x03 0xFF
mdLightGreenA	700	= V4 0x64 0xDD 0x17 0xFF
mdLime	50	        = V4 0xF9 0xFB 0xE7 0xFF
mdLime	100	        = V4 0xF0 0xF4 0xC3 0xFF
mdLime	200	        = V4 0xE6 0xEE 0x9C 0xFF
mdLime	300	        = V4 0xDC 0xE7 0x75 0xFF
mdLime	400	        = V4 0xD4 0xE1 0x57 0xFF
mdLime	500	        = V4 0xCD 0xDC 0x39 0xFF
mdLime	600	        = V4 0xC0 0xCA 0x33 0xFF
mdLime	700	        = V4 0xAF 0xB4 0x2B 0xFF
mdLime	800	        = V4 0x9E 0x9D 0x24 0xFF
mdLime	900	        = V4 0x82 0x77 0x17 0xFF
mdLimeA	100	        = V4 0xF4 0xFF 0x81 0xFF
mdLimeA	200	        = V4 0xEE 0xFF 0x41 0xFF
mdLimeA	400	        = V4 0xC6 0xFF 0x00 0xFF
mdLimeA	700	        = V4 0xAE 0xEA 0x00 0xFF
mdYellow	50	    = V4 0xFF 0xFD 0xE7 0xFF
mdYellow	100	    = V4 0xFF 0xF9 0xC4 0xFF
mdYellow	200	    = V4 0xFF 0xF5 0x9D 0xFF
mdYellow	300	    = V4 0xFF 0xF1 0x76 0xFF
mdYellow	400	    = V4 0xFF 0xEE 0x58 0xFF
mdYellow	500	    = V4 0xFF 0xEB 0x3B 0xFF
mdYellow	600	    = V4 0xFD 0xD8 0x35 0xFF
mdYellow	700	    = V4 0xFB 0xC0 0x2D 0xFF
mdYellow	800	    = V4 0xF9 0xA8 0x25 0xFF
mdYellow	900	    = V4 0xF5 0x7F 0x17 0xFF
mdYellowA	100	    = V4 0xFF 0xFF 0x8D 0xFF
mdYellowA	200	    = V4 0xFF 0xFF 0x00 0xFF
mdYellowA	400	    = V4 0xFF 0xEA 0x00 0xFF
mdYellowA	700	    = V4 0xFF 0xD6 0x00 0xFF
mdAmber	50	        = V4 0xFF 0xF8 0xE1 0xFF
mdAmber	100	        = V4 0xFF 0xEC 0xB3 0xFF
mdAmber	200	        = V4 0xFF 0xE0 0x82 0xFF
mdAmber	300	        = V4 0xFF 0xD5 0x4F 0xFF
mdAmber	400	        = V4 0xFF 0xCA 0x28 0xFF
mdAmber	500	        = V4 0xFF 0xC1 0x07 0xFF
mdAmber	600	        = V4 0xFF 0xB3 0x00 0xFF
mdAmber	700	        = V4 0xFF 0xA0 0x00 0xFF
mdAmber	800	        = V4 0xFF 0x8F 0x00 0xFF
mdAmber	900	        = V4 0xFF 0x6F 0x00 0xFF
mdAmberA	100	    = V4 0xFF 0xE5 0x7F 0xFF
mdAmberA	200	    = V4 0xFF 0xD7 0x40 0xFF
mdAmberA	400	    = V4 0xFF 0xC4 0x00 0xFF
mdAmberA	700	    = V4 0xFF 0xAB 0x00 0xFF
mdOrange	50	    = V4 0xFF 0xF3 0xE0 0xFF
mdOrange	100	    = V4 0xFF 0xE0 0xB2 0xFF
mdOrange	200	    = V4 0xFF 0xCC 0x80 0xFF
mdOrange	300	    = V4 0xFF 0xB7 0x4D 0xFF
mdOrange	400	    = V4 0xFF 0xA7 0x26 0xFF
mdOrange	500	    = V4 0xFF 0x98 0x00 0xFF
mdOrange	600	    = V4 0xFB 0x8C 0x00 0xFF
mdOrange	700	    = V4 0xF5 0x7C 0x00 0xFF
mdOrange	800	    = V4 0xEF 0x6C 0x00 0xFF
mdOrange	900	    = V4 0xE6 0x51 0x00 0xFF
mdOrangeA	100	    = V4 0xFF 0xD1 0x80 0xFF
mdOrangeA	200	    = V4 0xFF 0xAB 0x40 0xFF
mdOrangeA	400	    = V4 0xFF 0x91 0x00 0xFF
mdOrangeA	700	    = V4 0xFF 0x6D 0x00 0xFF
mdDeepOrange	50	= V4 0xFB 0xE9 0xE7 0xFF
mdDeepOrange	100	= V4 0xFF 0xCC 0xBC 0xFF
mdDeepOrange	200	= V4 0xFF 0xAB 0x91 0xFF
mdDeepOrange	300	= V4 0xFF 0x8A 0x65 0xFF
mdDeepOrange	400	= V4 0xFF 0x70 0x43 0xFF
mdDeepOrange	500	= V4 0xFF 0x57 0x22 0xFF
mdDeepOrange	600	= V4 0xF4 0x51 0x1E 0xFF
mdDeepOrange	700	= V4 0xE6 0x4A 0x19 0xFF
mdDeepOrange	800	= V4 0xD8 0x43 0x15 0xFF
mdDeepOrange	900	= V4 0xBF 0x36 0x0C 0xFF
mdDeepOrangeA	100	= V4 0xFF 0x9E 0x80 0xFF
mdDeepOrangeA	200	= V4 0xFF 0x6E 0x40 0xFF
mdDeepOrangeA	400	= V4 0xFF 0x3D 0x00 0xFF
mdDeepOrangeA	700	= V4 0xDD 0x2C 0x00 0xFF
mdBrown	50	        = V4 0xEF 0xEB 0xE9 0xFF
mdBrown	100	        = V4 0xD7 0xCC 0xC8 0xFF
mdBrown	200	        = V4 0xBC 0xAA 0xA4 0xFF
mdBrown	300	        = V4 0xA1 0x88 0x7F 0xFF
mdBrown	400	        = V4 0x8D 0x6E 0x63 0xFF
mdBrown	500	        = V4 0x79 0x55 0x48 0xFF
mdBrown	600	        = V4 0x6D 0x4C 0x41 0xFF
mdBrown	700	        = V4 0x5D 0x40 0x37 0xFF
mdBrown	800	        = V4 0x4E 0x34 0x2E 0xFF
mdBrown	900	        = V4 0x3E 0x27 0x23 0xFF
mdGray	50	        = V4 0xFA 0xFA 0xFA 0xFF
mdGray	100	        = V4 0xF5 0xF5 0xF5 0xFF
mdGray	200	        = V4 0xEE 0xEE 0xEE 0xFF
mdGray	300	        = V4 0xE0 0xE0 0xE0 0xFF
mdGray	400	        = V4 0xBD 0xBD 0xBD 0xFF
mdGray	500	        = V4 0x9E 0x9E 0x9E 0xFF
mdGray	600	        = V4 0x75 0x75 0x75 0xFF
mdGray	700	        = V4 0x61 0x61 0x61 0xFF
mdGray	800	        = V4 0x42 0x42 0x42 0xFF
mdGray	900	        = V4 0x21 0x21 0x21 0xFF
mdBlueGray	50	    = V4 0xEC 0xEF 0xF1 0xFF
mdBlueGray	100	    = V4 0xCF 0xD8 0xDC 0xFF
mdBlueGray	200	    = V4 0xB0 0xBE 0xC5 0xFF
mdBlueGray	300	    = V4 0x90 0xA4 0xAE 0xFF
mdBlueGray	400	    = V4 0x78 0x90 0x9C 0xFF
mdBlueGray	500	    = V4 0x60 0x7D 0x8B 0xFF
mdBlueGray	600	    = V4 0x54 0x6E 0x7A 0xFF
mdBlueGray	700	    = V4 0x45 0x5A 0x64 0xFF
mdBlueGray	800	    = V4 0x37 0x47 0x4F 0xFF
mdBlueGray	900	    = V4 0x26 0x32 0x38 0xFF